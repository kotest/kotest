"use strict";(self.webpackChunkkotestdocs=self.webpackChunkkotestdocs||[]).push([[9516],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),p=u(n),f=a,m=p["".concat(l,".").concat(f)]||p[f]||d[f]||o;return n?i.createElement(m,s(s({ref:t},c),{},{components:n})):i.createElement(m,s({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=p;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:a,s[1]=r;for(var u=2;u<o;u++)s[u]=n[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},71233:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>u});var i=n(87462),a=(n(67294),n(3905));const o={id:"shared_test_config",title:"Shared Test Config",slug:"sharedtestconfig.html"},s="Shared Test Config",r={unversionedId:"framework/shared_test_config",id:"version-6.0/framework/shared_test_config",title:"Shared Test Config",description:"This page describes how to use DefaultTestConfig to share test configuration across multiple test cases in your specs.",source:"@site/versioned_docs/version-6.0/framework/shared_test_config.md",sourceDirName:"framework",slug:"/framework/sharedtestconfig.html",permalink:"/docs/6.0/framework/sharedtestconfig.html",draft:!1,editUrl:"https://github.com/kotest/kotest/blob/master/documentation/versioned_docs/version-6.0/framework/shared_test_config.md",tags:[],version:"6.0",frontMatter:{id:"shared_test_config",title:"Shared Test Config",slug:"sharedtestconfig.html"},sidebar:"framework",previous:{title:"Package Level Config",permalink:"/docs/6.0/framework/package-level-config.html"},next:{title:"System properties",permalink:"/docs/6.0/framework/framework-config-props.html"}},l={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Available Configuration Options",id:"available-configuration-options",level:2},{value:"Examples",id:"examples",level:2},{value:"Example: Setting Retry Configuration",id:"example-setting-retry-configuration",level:3},{value:"Example: Setting Timeouts and Invocations",id:"example-setting-timeouts-and-invocations",level:3},{value:"Example: Using Tags and Assertion Mode",id:"example-using-tags-and-assertion-mode",level:3},{value:"Overriding Default Configuration",id:"overriding-default-configuration",level:2}],c={toc:u};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"shared-test-config"},"Shared Test Config"),(0,a.kt)("p",null,"This page describes how to use ",(0,a.kt)("inlineCode",{parentName:"p"},"DefaultTestConfig")," to share test configuration across multiple test cases in your specs."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"This feature is available in Kotest 6.0 and later.")),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"When writing tests, you often need to apply the same configuration to multiple test files.\nInstead of repeating the same configuration for each test, you can use ",(0,a.kt)("inlineCode",{parentName:"p"},"DefaultTestConfig")," to define a\nshared configuration that applies to all tests in a spec."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"DefaultTestConfig")," is a data class that allows for the configuration of test cases to be easily shared."),(0,a.kt)("p",null,"Each of the configuration values can be overridden on a per-test basis, but if you wish to have a common set of\ndefaults that are shared across several tests, then you can create an instance of this class and declare it in each of\nthe specs that you wish to share the configuration."),(0,a.kt)("h2",{id:"basic-usage"},"Basic Usage"),(0,a.kt)("p",null,"To set a default configuration for all tests in a spec, assign a ",(0,a.kt)("inlineCode",{parentName:"p"},"DefaultTestConfig")," instance to the ",(0,a.kt)("inlineCode",{parentName:"p"},"defaultTestConfig"),"\nproperty in your spec:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'class MySpec : FunSpec() {\n  init {\n\n    defaultTestConfig = DefaultTestConfig(\n      timeout = 2.seconds,\n      invocations = 3,\n      threads = 2\n    )\n\n    // All tests in this spec will use the above configuration by default\n    test("test with default config") {\n      // This test will run 3 times with a timeout of 2 seconds\n    }\n\n    // You can still override the default config for specific tests\n    test("test with custom config").config(timeout = 5.seconds) {\n      // This test will run 3 times (from default config) with a timeout of 5 seconds\n    }\n  }\n}\n')),(0,a.kt)("h2",{id:"available-configuration-options"},"Available Configuration Options"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"DefaultTestConfig")," supports the following configuration options:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"timeout"),": Maximum time a test is allowed to run before it is considered a failure"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"invocationTimeout"),": Maximum time each individual invocation is allowed to run"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"invocations"),": Number of times to run each test"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"assertSoftly"),": Whether to use soft assertions for all tests"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"tags"),": Set of tags to apply to all tests"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"severity"),": Severity level for all tests"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"enabledIf"),": Function that determines if tests should be enabled"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"enabledOrReasonIf"),": Function that determines if tests should be enabled and provides a reason if not"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"assertionMode"),": Assertion mode to use for all tests"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"testOrder"),": Order in which to run tests"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"blockingTest"),": Whether tests should be run in a blocking manner"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"coroutineTestScope"),": Whether to use a coroutine test scope"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"coroutineDebugProbes"),": Whether to enable coroutine debug probes"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"duplicateTestNameMode"),": How to handle duplicate test names"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"failfast"),": Whether to fail fast on the first failure"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"retries"),": Number of times to retry a failing test"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"retryDelay"),": Delay between retries")),(0,a.kt)("h2",{id:"examples"},"Examples"),(0,a.kt)("h3",{id:"example-setting-retry-configuration"},"Example: Setting Retry Configuration"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'class RetrySpec : DescribeSpec() {\n  init {\n\n    defaultTestConfig = DefaultTestConfig(retries = 5, retryDelay = 20.milliseconds)\n\n    describe("a flaky test") {\n      // This test will be retried up to 5 times with a 20ms delay between retries\n      it("should eventually pass") {\n        // Test logic here\n      }\n    }\n  }\n}\n')),(0,a.kt)("h3",{id:"example-setting-timeouts-and-invocations"},"Example: Setting Timeouts and Invocations"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'class PerformanceSpec : StringSpec() {\n  init {\n\n    defaultTestConfig = DefaultTestConfig(\n      timeout = 1.minutes,\n      invocations = 10,\n      invocationTimeout = 5.seconds\n    )\n\n    "performance test" {\n      // This test will run 10 times, with each invocation having a 5 second timeout\n      // The entire test has a 1 minute timeout\n    }\n  }\n}\n')),(0,a.kt)("h3",{id:"example-using-tags-and-assertion-mode"},"Example: Using Tags and Assertion Mode"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'class IntegrationSpec : FunSpec() {\n  init {\n\n    defaultTestConfig = DefaultTestConfig(\n      tags = setOf(Tags.Integration, Tags.Slow),\n      assertionMode = AssertionMode.Error\n    )\n\n    test("database connection") {\n      // This test will be tagged as Integration and Slow\n      // Assertions will throw errors instead of exceptions\n    }\n  }\n}\n')),(0,a.kt)("h2",{id:"overriding-default-configuration"},"Overriding Default Configuration"),(0,a.kt)("p",null,"Individual tests can override any part of the default configuration using the ",(0,a.kt)("inlineCode",{parentName:"p"},".config()")," method:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-kotlin"},'class MixedSpec : FunSpec() {\n  init {\n    defaultTestConfig = DefaultTestConfig(\n      timeout = 10.seconds,\n      invocations = 3\n    )\n\n    test("uses default config") {\n      // Uses timeout = 10.seconds and invocations = 3\n    }\n\n    test("overrides timeout only").config(timeout = 30.seconds) {\n      // Uses timeout = 30.seconds and invocations = 3 (from default)\n    }\n\n    test("overrides everything").config(timeout = 5.seconds, invocations = 1) {\n      // Uses timeout = 5.seconds and invocations = 1\n    }\n  }\n}\n')),(0,a.kt)("p",null,"The order of lookups is as follows:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Test-specific configuration (set via ",(0,a.kt)("inlineCode",{parentName:"li"},".config()"),")"),(0,a.kt)("li",{parentName:"ol"},"Spec-level overrides (set via variables in the spec class)"),(0,a.kt)("li",{parentName:"ol"},"Spec-level default configuration (set via ",(0,a.kt)("inlineCode",{parentName:"li"},"defaultTestConfig"),")"),(0,a.kt)("li",{parentName:"ol"},"Package-level default configuration (set via ",(0,a.kt)("inlineCode",{parentName:"li"},"PackageConfig"),")"),(0,a.kt)("li",{parentName:"ol"},"Global configuration (set via ",(0,a.kt)("inlineCode",{parentName:"li"},"ProjectConfig"),")"),(0,a.kt)("li",{parentName:"ol"},"System properties or environment variables")))}d.isMDXComponent=!0}}]);
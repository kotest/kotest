"use strict";(self.webpackChunkkotestdocs=self.webpackChunkkotestdocs||[]).push([[35150],{3905:(t,e,n)=>{n.d(e,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},i=Object.keys(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var l=a.createContext({}),d=function(t){var e=a.useContext(l),n=e;return t&&(n="function"==typeof t?t(e):s(s({},e),t)),n},p=function(t){var e=d(t.components);return a.createElement(l.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,i=t.originalType,l=t.parentName,p=o(t,["components","mdxType","originalType","parentName"]),u=d(n),m=r,h=u["".concat(l,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(h,s(s({ref:e},p),{},{components:n})):a.createElement(h,s({ref:e},p))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=n.length,s=new Array(i);s[0]=u;var o={};for(var l in e)hasOwnProperty.call(e,l)&&(o[l]=e[l]);o.originalType=t,o.mdxType="string"==typeof t?t:r,s[1]=o;for(var d=2;d<i;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},43752:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=n(87462),r=(n(67294),n(3905));const i={id:"introduction",title:"Introduction",slug:"data-driven-testing.html"},s=void 0,o={unversionedId:"framework/datatesting/introduction",id:"version-6.1/framework/datatesting/introduction",title:"Introduction",description:"Prior to kotest 6.0, data-driven-testing was a separate module. Starting from kotest 6.0, data-driven-testing is",source:"@site/versioned_docs/version-6.1/framework/datatesting/data_driven_testing.md",sourceDirName:"framework/datatesting",slug:"/framework/datatesting/data-driven-testing.html",permalink:"/docs/framework/datatesting/data-driven-testing.html",draft:!1,editUrl:"https://github.com/kotest/kotest/blob/master/documentation/versioned_docs/version-6.1/framework/datatesting/data_driven_testing.md",tags:[],version:"6.1",frontMatter:{id:"introduction",title:"Introduction",slug:"data-driven-testing.html"},sidebar:"framework",previous:{title:"Exceptions",permalink:"/docs/framework/exceptions.html"},next:{title:"Data Test Names",permalink:"/docs/framework/datatesting/custom-test-names.html"}},l={},d=[{value:"Getting Started",id:"getting-started",level:2},{value:"Nesting",id:"nesting",level:2},{value:"Native Support",id:"native-support",level:3},{value:"Lifecycle Hooks",id:"lifecycle-hooks",level:2},{value:"WithXXX Variants",id:"withxxx-variants",level:2}],p={toc:d};function c(t){let{components:e,...i}=t;return(0,r.kt)("wrapper",(0,a.Z)({},p,i,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("admonition",{title:"Module Changes",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Prior to kotest 6.0, data-driven-testing was a separate module. Starting from kotest 6.0, data-driven-testing is\nincluded in the core framework so there is no ",(0,r.kt)("inlineCode",{parentName:"p"},"kotest-framework-datatest")," to be added. Please remove that from your build.")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"This section covers the new and improved data-driven testing support that was released with Kotest 4.6.0.\nTo view the documentation for the previous data test support, ",(0,r.kt)("a",{parentName:"p",href:"/docs/framework/datatesting/data_driven_testing_4.2.0"},"click here"))),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"If you are using data testing on kotlin-native platforms, and you only have data tests (ie, zero manual tests) then see the section on Native Support.")),(0,r.kt)("p",null,"When writing tests that are logic-based, then specific code paths that work through particular scenarios make\nsense. Other times we have tests that are more example-based, and it would be helpful to test many combinations of\nparameters."),(0,r.kt)("p",null,"In these situations, ",(0,r.kt)("strong",{parentName:"p"},"data driven testing")," (also called table-driven testing) is an easy technique to avoid tedious\nboilerplate."),(0,r.kt)("p",null,"Kotest has first-class support for data-driven testing built into the framework.\nThis means Kotest will automatically generate test case entries, based on input values provided by you."),(0,r.kt)("h2",{id:"getting-started"},"Getting Started"),(0,r.kt)("p",null,"Let's consider writing tests for a Celsius to Fahrenheit conversion function. The input will be the Celsius value,\nand the expected output will be the Fahrenheit value."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},"fun cToF(celsius: Int): Int = (celsius * 9 / 5) + 32\n")),(0,r.kt)("p",null,"Depending on the spec style in use, Kotest provides ",(0,r.kt)("inlineCode",{parentName:"p"},"withXXX")," methods which mirror the DSL provided by each spec style.\nFor example, if we are using the ",(0,r.kt)("em",{parentName:"p"},"fun spec")," style, then we can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"withTests")," function."),(0,r.kt)("p",null,"When creating data tests, we need to provide each set of inputs (called a ",(0,r.kt)("em",{parentName:"p"},"row"),") wrapped in a class. Since in this\nexample we need two arguments per row, so we can wrap the inputs in a Kotlin ",(0,r.kt)("inlineCode",{parentName:"p"},"Pair")," object. If we had more than two\narguments, we could use a custom data class instead."),(0,r.kt)("p",null,"We create a data test by using the ",(0,r.kt)("inlineCode",{parentName:"p"},"withXXX")," function, passing in the rows, and also a lambda that performs the test\nlogic for that given ",(0,r.kt)("em",{parentName:"p"},"row"),"."),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},"class MyTests : FunSpec({\n  withTests(\n    Pair(0, 32),\n    Pair(100, 212),\n    Pair(-40, -4),\n    Pair(-30, -30),\n  )\n  { (celsius, fahrenheit) ->\n    cToF(celsius) shouldBe fahrenheit\n  }\n})\n")),(0,r.kt)("p",null,"Notice that because we are using Pair's, or data classes, the input row can be destructured into the member properties."),(0,r.kt)("p",null,"Kotest will automatically generate a test case for each input row, as if you had manually written a separate test case.\nSo, in this example when this data test is executed, we will have four separate test results in our output."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"data test example output",src:n(88740).Z,width:"528",height:"216"})),(0,r.kt)("p",null,"The test names are generated from the data classes themselves but can be ",(0,r.kt)("a",{parentName:"p",href:"/docs/framework/datatesting/custom-test-names.html"},"customized"),"."),(0,r.kt)("p",null,"If there is an error for any particular input row, then the test will fail and Kotest will output the values that\nfailed. For example, if we change the previous example to include the row ",(0,r.kt)("inlineCode",{parentName:"p"},"PythagTriple(5, 4, 3)"),"\nthen that test will be marked as a failure."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"data test example output",src:n(12938).Z,width:"529",height:"249"})),(0,r.kt)("p",null,"The error message will contain the error and the input row details:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Test failed for (a, 5), (b, 4), (c, 3) expected:<9> but was:<41>")),(0,r.kt)("h2",{id:"nesting"},"Nesting"),(0,r.kt)("p",null,"In the previous example, we placed the data tests at the root level. We can also nest data tests inside other\ncontainers or even other data tests. For example, we can wrap the previous example in a ",(0,r.kt)("inlineCode",{parentName:"p"},"context")," block so we have more\ninformation when the test results appear. In fact, data tests can be nested inside any number of containers."),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},'class MyTests : FunSpec({\n  context("celsius to fahrenheit") {\n    withTests(\n      Pair(0, 32),\n      Pair(100, 212),\n      Pair(-40, -4),\n      Pair(-30, -30),\n    )\n    { (celsius, fahrenheit) ->\n      cToF(celsius) shouldBe fahrenheit\n    }\n  }\n})\n')),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Data tests can only be defined at the root or in container scopes. They cannot be defined inside leaf scopes.")),(0,r.kt)("h3",{id:"native-support"},"Native Support"),(0,r.kt)("p",null,"If you are using data testing on kotlin-native platforms, and you only have data tests (ie, zero manual tests), then you must instruct\nthe Kotlin Gradle plugin to not fail the build because ",(0,r.kt)("em",{parentName:"p"},"no tests are discovered"),". This happens because data tests are generated at runtime by Kotest,\nthe kotlin-native test discovery mechanism does not see any tests at compile time. Again, this only matters if you are using data tests exclusively."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},"tasks.withType<KotlinTest>().configureEach {\n  failOnNoDiscoveredTests = false\n}\n")),(0,r.kt)("h2",{id:"lifecycle-hooks"},"Lifecycle Hooks"),(0,r.kt)("p",null,"If you wish to have before / after hooks take effect for each row in a data test, then you can use the standard hooks\nthat Kotest supports, including ",(0,r.kt)("inlineCode",{parentName:"p"},"beforeTest")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"afterTest")," for example. Every test created using data-driven testing\nacts the same way as the equivalent regular tests, so all standard callbacks work as if you had written all the tests by\nhand. See ",(0,r.kt)("a",{parentName:"p",href:"/docs/framework/lifecycle-hooks.html"},"docs on lifecycle hooks")),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},'beforeTest {\n  // reset test setup\n}\n\ncontext("...") {\n  withTests(X, Y, Z) { x,y,z ->\n    // test code\n  }\n}\n')),(0,r.kt)("h2",{id:"withxxx-variants"},"WithXXX Variants"),(0,r.kt)("p",null,"Each spec style has its own set of ",(0,r.kt)("inlineCode",{parentName:"p"},"withXXX")," which define either a container or a leaf context.\nCombinations per spec style are listed below:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Test Style"),(0,r.kt)("th",{parentName:"tr",align:null},"Available ",(0,r.kt)("inlineCode",{parentName:"th"},"withXXX")," Functions"),(0,r.kt)("th",{parentName:"tr",align:null},"Legacy ",(0,r.kt)("inlineCode",{parentName:"th"},"withData")," Maps To"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"FunSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts")," (creates container contexts)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withTests")," (creates leaf tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"StringSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withData")," (creates leaf tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withData")," (native)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"DescribeSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts")," (creates container contexts)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withDescribes")," (creates container describes)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withIts")," (creates leaf tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"ShouldSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts")," (creates container contexts)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withShoulds")," (creates leaf tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"WordSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withWhens")," (creates when containers)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withShoulds")," (creates should containers)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withWhens"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"BehaviorSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts")," (creates container contexts)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withGivens")," (creates given containers)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withWhens")," (creates when containers)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withThens")," (creates then leaf tests)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withAnds")," (creates and containers in given scope)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"FreeSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts")," (creates container contexts)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withTests")," (creates leaf tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"ExpectSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts")," (creates container contexts)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withExpects")," (creates leaf expect tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withContexts"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"FeatureSpec")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withFeatures")," (creates feature containers)",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"withScenarios")," (creates leaf scenario tests)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"withFeatures"))))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Versions of Kotest prior to 6.1 provided a single ",(0,r.kt)("inlineCode",{parentName:"p"},"withData")," function. This function still exists and points to an\nappropriate variant for that spec style. However, the new withXXX variants are preferred as you have control over whether\nyou are defining a container or a leaf test.")),(0,r.kt)("p",null,"Full examples of how each of these can be used can be found in these kotest ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kotest/kotest/tree/master/kotest-framework/kotest-framework-engine/src/jvmTest/kotlin/io/kotest/datatest/styles"},"tests")))}c.isMDXComponent=!0},88740:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/datatest1-55f0023d0e24fd14ff7081a3746e32ef.png"},12938:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/datatest2-caababc9c261775d74c2c236cbf23686.png"}}]);
"use strict";(self.webpackChunkkotestdocs=self.webpackChunkkotestdocs||[]).push([[54306],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>u});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=i.createContext({}),s=function(e){var t=i.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return i.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),d=s(n),u=o,h=d["".concat(p,".").concat(u)]||d[u]||m[u]||r;return n?i.createElement(h,l(l({ref:t},c),{},{components:n})):i.createElement(h,l({ref:t},c))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=d;var a={};for(var p in t)hasOwnProperty.call(t,p)&&(a[p]=t[p]);a.originalType=e,a.mdxType="string"==typeof e?e:o,l[1]=a;for(var s=2;s<r;s++)l[s]=n[s];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},94895:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>a,toc:()=>s});var i=n(87462),o=(n(67294),n(3905));const r={id:"compiler",title:"Compiler Matchers",slug:"compiler-matchers.html",sidebar_label:"Compiler"},l=void 0,a={unversionedId:"assertions/compiler",id:"version-6.0/assertions/compiler",title:"Compiler Matchers",description:"The `kotest-assertions-compiler` extension provides matchers to assert that given kotlin code snippet compiles or not.",source:"@site/versioned_docs/version-6.0/assertions/compiler.md",sourceDirName:"assertions",slug:"/assertions/compiler-matchers.html",permalink:"/docs/6.0/assertions/compiler-matchers.html",draft:!1,editUrl:"https://github.com/kotest/kotest/blob/master/documentation/versioned_docs/version-6.0/assertions/compiler.md",tags:[],version:"6.0",frontMatter:{id:"compiler",title:"Compiler Matchers",slug:"compiler-matchers.html",sidebar_label:"Compiler"},sidebar:"assertions",previous:{title:"Konform",permalink:"/docs/6.0/assertions/konform-matchers.html"},next:{title:"Matching By Field",permalink:"/docs/6.0/assertions/field-matching.html"}},p={},s=[],c={toc:s};function m(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"kotest-assertions-compiler")," extension provides matchers to assert that given kotlin code snippet compiles or not.\nThis extension is a wrapper over ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tschuchortdev/kotlin-compile-testing"},"kotlin-compile-testing")," and provides following matchers"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"String.shouldCompile()"),(0,o.kt)("li",{parentName:"ul"},"String.shouldNotCompile()"),(0,o.kt)("li",{parentName:"ul"},"CodeSnippet.shouldCompile()"),(0,o.kt)("li",{parentName:"ul"},"CodeSnippet.shouldNotCompile()"),(0,o.kt)("li",{parentName:"ul"},"File.shouldCompile()"),(0,o.kt)("li",{parentName:"ul"},"File.shouldNotCompile()")),(0,o.kt)("p",null,"To add the compilation matcher, add the following dependency to your project"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'testImplementation("io.kotest.extensions:kotest-assertions-compiler:$version")\n')),(0,o.kt)("p",null,"Usage:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-kotlin"},'class CompilationTest : FreeSpec({\n    "shouldCompile test" {\n        val rawStringCodeSnippet = """\n            val aString: String = "A valid assignment"\n        """\n\n        val syntaxHighlightedSnippet = codeSnippet("""\n            val aString: String = "A valid assignment"\n        """)\n\n        rawStringCodeSnippet.shouldCompile()\n        syntaxHighlightedSnippet.shouldCompile()\n        File("SourceFile.kt").shouldCompile()\n    }\n\n    "shouldNotCompile test" {\n        val rawStringCodeSnippet = """\n            val anInteger: Int = "An invalid assignment"\n        """\n\n        val syntaxHighlightedSnippet = codeSnippet("""\n            val anInteger: Int = "An invalid assignment"\n        """)\n\n        rawStringCodeSnippet.shouldNotCompile()\n        syntaxHighlightedSnippet.shouldNotCompile()\n        File("SourceFile.kt").shouldNotCompile()\n\n        // check that a compilation error occurred for a specific reason\n        rawStringCodeSnippet.shouldNotCompile("expected \'Int\', actual \'String\'")\n        syntaxHighlightedSnippet.shouldNotCompile("expected \'Int\', actual \'String\'")\n        File("SourceFile.kt").shouldNotCompile("expected \'Int\', actual \'String\'")\n    }\n\n    @OptIn(ExperimentalCompilerApi::class)\n    "custom assertions on JvmCompilationResult" {\n        val codeSnippet = codeSnippet("""\n            fun foo() {\n                printDate(LocalDate.now())\n            }\n        """)\n\n        codeSnippet.compile {\n            exitCode shouldBe ExitCode.COMPILATION_ERROR\n            messages shouldContain "Unresolved reference \'LocalDate\'"\n            messages shouldContain "Unresolved reference \'printDate\'"\n        }\n    }\n\n    @OptIn(ExperimentalCompilerApi::class)\n    "custom compiler configuration" {\n        val compileConfig = CompileConfig {\n            compilerPluginRegistrars = listOf(MyCompilerPluginRegistrar())\n        }\n        val codeSnippet = compileConfig.codeSnippet("""\n            @MyAnnotation\n            fun hello() {}\n        """)\n\n        codeSnippet.shouldCompile()\n    }\n})\n')),(0,o.kt)("p",null,"During checking of code snippet compilation the classpath of calling process is inherited, which means any dependencies which are available in calling process will also be available while compiling the code snippet."),(0,o.kt)("p",null,"Matchers that verify if a given piece of Kotlin code compiles or not"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Matcher"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String.shouldCompile()")),(0,o.kt)("td",{parentName:"tr",align:null},"Asserts that the raw string snippet compiles")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"CodeSnippet.shouldCompile()")),(0,o.kt)("td",{parentName:"tr",align:null},"Same as above, with syntax highlighting")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"File.shouldCompile()")),(0,o.kt)("td",{parentName:"tr",align:null},"Same as above, from a file")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String.shouldNotCompile(msg?)")),(0,o.kt)("td",{parentName:"tr",align:null},"Asserts it fails, optionally for a specific reason")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"CodeSnippet.shouldNotCompile(msg?)")),(0,o.kt)("td",{parentName:"tr",align:null},"Save as above, with syntax highlighting")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"File.shouldNotCompile(msg?)")),(0,o.kt)("td",{parentName:"tr",align:null},"Same as above, from a file")))))}m.isMDXComponent=!0}}]);